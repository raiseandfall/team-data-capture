function alertContents(){4===httpRequest.readyState&&(200===httpRequest.status?(console.log(httpRequest.responseText),stats.display(httpRequest.responseText)):console.log("There was a problem with the request."))}function makeRequest(a){if(window.XMLHttpRequest)httpRequest=new XMLHttpRequest;else if(window.ActiveXObject)try{httpRequest=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{httpRequest=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}return httpRequest?(httpRequest.onreadystatechange=alertContents,httpRequest.open("GET",a),void httpRequest.send()):(console.log("Giving up :( Cannot create an XMLHTTP instance"),!1)}(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.1";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(null==b?x.identity:b);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e=null;return function(){var f=this,g=arguments,h=function(){e=null,c||(d=a.apply(f,g))},i=c&&!e;return clearTimeout(e),e=setTimeout(h,b),i&&(d=a.apply(f,g)),d}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};!function(){var a=[],b=a.slice,c=function(a,b,c){var d,e=-1,f=b.length;switch(c.length){case 0:for(;++e<f;)(d=b[e]).callback.call(d.ctx);return;case 1:for(;++e<f;)(d=b[e]).callback.call(d.ctx,c[0]);return;case 2:for(;++e<f;)(d=b[e]).callback.call(d.ctx,c[0],c[1]);return;case 3:for(;++e<f;)(d=b[e]).callback.call(d.ctx,c[0],c[1],c[2]);return;default:for(;++e<f;)(d=b[e]).callback.apply(d.ctx,c)}},d=Backbone.Events={on:function(a,b,c){this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){var d=this,e=_.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c),this},off:function(a,b,c){var d,e,f,g,h,i,j,k;if(!this._events)return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:_.keys(this._events),h=0,i=g.length;i>h;h++)if(a=g[h],d=this._events[a]){if(f=[],b||c)for(j=0,k=d.length;k>j;j++)e=d[j],(b&&b!==(e.callback._callback||e.callback)||c&&c!==e.context)&&f.push(e);this._events[a]=f}return this},trigger:function(a){if(!this._events)return this;var d=b.call(arguments,1),e=this._events[a],f=this._events.all;return e&&c(this,e,d),f&&c(this,f,arguments),this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),e=a._listenerId||(a._listenerId=_.uniqueId("l"));return d[e]=a,a.on(b,c||this,this),this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),b||c||delete d[a._listenerId];else{for(var e in d)d[e].off(null,null,this);this._listeners={}}return this}}};d.bind=d.on,d.unbind=d.off,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=d),exports.Backbone=exports.Backbone||Backbone)}(),function(){function a(a){var d=(new Date).getTime(),e=Math.max(0,16-(d-c)),f=b.setTimeout(function(){a(d+e)},e);return c=d+e,f}var b=this,c=0,d=["ms","moz","webkit","o"];if("undefined"!=typeof exports)return"undefined"!=typeof module&&module.exports&&(exports=module.exports=a),void(exports.requestAnimationFrame=a);for(var e=0;e<d.length&&!b.requestAnimationFrame;++e)b.requestAnimationFrame=b[d[e]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[d[e]+"CancelAnimationFrame"]||b[d[e]+"CancelRequestAnimationFrame"];b.requestAnimationFrame||(b.requestAnimationFrame=a),b.cancelAnimationFrame||(b.cancelAnimationFrame=function(a){clearTimeout(a)})}(),function(){function a(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,c=this.height=a.height;this.renderer.setSize(b,c,this.ratio),this.trigger(o.Events.resize,b,c)}function b(){return(c.performance&&c.performance.now?c.performance:Date).now()}var c=this,d=c.Two||{},e=Math.sin,f=Math.cos,g=Math.atan2,h=Math.sqrt,i=(Math.round,Math.abs),j=Math.PI,k=2*j,l=j/2,m=Math.pow,n={hasEventListeners:_.isFunction(c.addEventListener),bind:function(a,b,c,d){return this.hasEventListeners?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c),this},unbind:function(a,b,c,d){return this.hasEventListeners?a.removeEventListeners(b,c,!!d):a.detachEvent("on"+b,c),this}},o=c.Two=function(b){var d=_.defaults(b||{},{fullscreen:!1,width:640,height:480,type:o.Types.svg,autostart:!1});if(_.each(d,function(a,b){"fullscreen"!==b&&"width"!==b&&"height"!==b&&"autostart"!==b&&(this[b]=a)},this),_.isElement(d.domElement)&&(this.type=o.Types[d.domElement.tagName.toLowerCase()]),this.renderer=new o[this.type](this),o.Utils.setPlaying.call(this,d.autostart),this.frameCount=0,d.fullscreen){var e=_.bind(a,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),n.bind(c,"resize",e),e()}else _.isElement(d.domElement)||(this.renderer.setSize(d.width,d.height,this.ratio),this.width=d.width,this.height=d.height);this.scene=new o.Group,this.renderer.add(this.scene),o.Instances.push(this)};_.extend(o,{Array:c.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.3.0",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return c.Two=d,this},Utils:{Curve:{CollinearityEpsilon:m(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},getComputedMatrix:function(a){for(var b=new o.Matrix,c=a;c&&c._matrix;){var d=c._matrix.elements;b.multiply(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9]),c=c.parent}return b},applySvgAttributes:function(a,b){return b.cap="butt",b.join="bevel",_.each(a.attributes,function(a){var c=a.nodeName;switch(c){case"transform":break;case"visibility":b.visible=!!a.nodeValue;break;case"stroke-linecap":b.cap=a.nodeValue;break;case"stroke-linejoin":b.join=a.nodeValue;break;case"stroke-miterlimit":b.miter=a.nodeValue;break;case"stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case"stroke-opacity":case"fill-opacity":b.opacity=a.nodeValue;break;case"fill":b.fill=a.nodeValue;break;case"stroke":b.stroke=a.nodeValue}}),b},read:{svg:function(){return o.Utils.read.g.apply(this,arguments)},g:function(a){var b=new o.Group;return this.add(b),_.each(a.childNodes,function(a){var c=a.nodeName;if(c){var d=c.replace(/svg\:/gi,"").toLowerCase();if(d in o.Utils.read){var e=o.Utils.read[d].call(this,a);b.add(e)}}},this),o.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var c=a.getAttribute("points"),d=[];c.replace(/([\d\.?]+),([\d\.?]+)/g,function(a,b,c){d.push(new o.Anchor(parseFloat(b),parseFloat(c)))});var e=new o.Polygon(d,!b).noStroke();return o.Utils.applySvgAttributes(a,e)},polyline:function(a){return o.Utils.read.polygon(a,!0)},path:function(a){var b,c,d,e=a.getAttribute("d"),f=!1,g=!1,h=e.match(/[a-df-z][^a-df-z]*/gi),i=h.length-1,j=_.flatten(_.map(h,function(a,e){var h,j,k,l=a[0],m=l.toLowerCase();d=a.slice(1).trim(),d=d.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,c){return parseFloat(b)*Math.pow(10,c)}),d=d.split(/[\s,]+|(?=\s?[+\-])/),f=l===m;var n,p,q,r,s,t,u,v,w;switch(m){case"z":e>=i?g=!0:(j=b.x,k=b.y,h=new o.Anchor(j,k,void 0,void 0,void 0,void 0,o.Commands.close));break;case"m":case"l":j=parseFloat(d[0]),k=parseFloat(d[1]),h=new o.Anchor(j,k,void 0,void 0,void 0,void 0,"m"===m?o.Commands.move:o.Commands.line),f&&h.addSelf(b),b=h;break;case"h":case"v":var x="h"===m?"x":"y",y="x"===x?"y":"x";h=new o.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,o.Commands.line),h[x]=parseFloat(d[0]),h[y]=b[y],f&&(h[x]+=b[x]),b=h;break;case"s":case"c":n=b.x,p=b.y,c||(c=(new o.Vector).copy(b)),"c"===m?(q=parseFloat(d[0]),r=parseFloat(d[1]),s=parseFloat(d[2]),t=parseFloat(d[3]),u=parseFloat(d[4]),v=parseFloat(d[5])):(w=o.Utils.getReflection(b,c,f),q=w.x,r=w.y,s=parseFloat(d[0]),t=parseFloat(d[1]),u=parseFloat(d[2]),v=parseFloat(d[3])),f&&(q+=n,r+=p,s+=n,t+=p,u+=n,v+=p),_.isObject(b.controls)||o.Anchor.AppendCurveProperties(b),b.controls.right.set(q,r),h=new o.Anchor(u,v,s,t,void 0,void 0,o.Commands.curve),b=h,c=h.controls.left;break;case"t":case"q":n=b.x,p=b.y,c||(c=(new o.Vector).copy(b)),c.isZero()?(q=n,r=p):(q=c.x,p=c.y),"q"===m?(s=parseFloat(d[0]),t=parseFloat(d[1]),u=parseFloat(d[1]),v=parseFloat(d[2])):(w=o.Utils.getReflection(b,c,f),s=w.x,t=w.y,u=parseFloat(d[0]),v=parseFloat(d[1])),f&&(q+=n,r+=p,s+=n,t+=p,u+=n,v+=p),_.isObject(b.controls)||o.Anchor.AppendCurveProperties(b),b.controls.right.set(q,r),h=new o.Anchor(u,v,s,t,void 0,void 0,o.Commands.curve),b=h,c=h.controls.left;break;case"a":throw new o.Utils.Error("not yet able to interpret Elliptical Arcs.")}return h}));if(!(j.length<=1)){j=_.compact(j);var k=new o.Polygon(j,g,void 0,!0).noStroke();return o.Utils.applySvgAttributes(a,k)}},circle:function(a){var b=parseFloat(a.getAttribute("cx")),c=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("r")),g=o.Resolution,h=_.map(_.range(g),function(a){var b=a/g,c=b*k,h=d*f(c),i=d*e(c);return new o.Anchor(h,i)},this),i=new o.Polygon(h,!0,!0).noStroke();return i.translation.set(b,c),o.Utils.applySvgAttributes(a,i)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),c=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("rx")),g=parseFloat(a.getAttribute("ry")),h=o.Resolution,i=_.map(_.range(h),function(a){var b=a/h,c=b*k,i=d*f(c),j=g*e(c);return new o.Anchor(i,j)},this),j=new o.Polygon(i,!0,!0).noStroke();return j.translation.set(b,c),o.Utils.applySvgAttributes(a,j)},rect:function(a){var b=parseFloat(a.getAttribute("x")),c=parseFloat(a.getAttribute("y")),d=parseFloat(a.getAttribute("width")),e=parseFloat(a.getAttribute("height")),f=d/2,g=e/2,h=[new o.Anchor(f,g),new o.Anchor(-f,g),new o.Anchor(-f,-g),new o.Anchor(f,-g)],i=new o.Polygon(h,!0).noStroke();return i.translation.set(b+f,c+g),o.Utils.applySvgAttributes(a,i)},line:function(a){var b=parseFloat(a.getAttribute("x1")),c=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),e=parseFloat(a.getAttribute("y2")),f=d-b,g=e-c,h=f/2,i=g/2,j=[new o.Anchor(-h,-i),new o.Anchor(h,i)],k=new o.Polygon(j).noFill();return k.translation.set(b+h,c+i),o.Utils.applySvgAttributes(a,k)}},subdivide:function(a,b,c,d,e,f,h,l,m){var n,p,q=o.Utils.Curve.CollinearityEpsilon,r=o.Utils.Curve.RecursionLimit,s=o.Utils.Curve.CuspLimit,t=o.Utils.Curve.Tolerance;if(m=m||0,m>r)return[];var u=(a+c)/2,v=(b+d)/2,w=(c+e)/2,x=(d+f)/2,y=(e+h)/2,z=(f+l)/2,A=(u+w)/2,B=(v+x)/2,C=(w+y)/2,D=(x+z)/2,E=(A+C)/2,F=(B+D)/2,G=h-a,H=l-b,I=i((c-h)*H-(d-l)*G),J=i((e-h)*H-(f-l)*G);if(m>0){if(I>q&&J>q&&(I+J)*(I+J)<=t.distance*(G*G+H*H)){if(t.angle<t.epsilon)return[new o.Anchor(E,F)];var K=g(f-d,e-c);if(n=i(K-g(d-b,c-a)),p=i(g(l-f,h-e)-K),n>=j&&(n=k-n),p>=j&&(p=k-p),n+p<t.angle)return[new o.Anchor(E,F)];if(0!==s){if(n>s)return[new o.Anchor(c,d)];if(p>s)return[new o.Anchor(e,f)]}}}else if(I>q)if(I*I<=t.distance*(G*G+H*H)){if(t.angle<t.epsilon)return[new o.Anchor(E,F)];if(n=i(g(f-d,e-c)-g(d-b,c-a)),n>=j&&(n=k-n),n<t.angle)return[new o.Anchor(c,d),new o.Anchor(e,f)];if(0!==s&&n>s)return[new o.Anchor(c,d)]}else if(J>q){if(J*J<=t.distance*(G*G+H*H)){if(t.angle<t.epsilon)return[new o.Anchor(E,F)];if(n=i(g(l-f,h-e)-g(f-d,e-c)),n>=j&&(n=k-n),n<t.angle)return[new o.Anchor(c,d),new o.Anchor(e,f)];if(0!==s&&n>s)return[new o.Anchor(e,f)]}}else if(G=E-(a+h)/2,H=F-(b+l)/2,G*G+H*H<=t.distance)return[new o.Anchor(E,F)];return o.Utils.subdivide(a,b,u,v,A,B,E,F,m+1).concat(o.Utils.subdivide(E,F,C,D,y,z,h,l,m+1))},getCurveFromPoints:function(a,b){for(var c=a.length,d=c-1,e=0;c>e;e++){var f=a[e];_.isObject(f.controls)||o.Anchor.AppendCurveProperties(f);var g=b?t(e-1,c):Math.max(e-1,0),h=b?t(e+1,c):Math.min(e+1,d),i=a[g],j=f,k=a[h];s(i,j,k),j._command=0===e?o.Commands.move:o.Commands.curve,j.controls.left.x=_.isNumber(j.controls.left.x)?j.controls.left.x:j.x,j.controls.left.y=_.isNumber(j.controls.left.y)?j.controls.left.y:j.y,j.controls.right.x=_.isNumber(j.controls.right.x)?j.controls.right.x:j.x,j.controls.right.y=_.isNumber(j.controls.right.y)?j.controls.right.y:j.y}},getControlPoints:function(a,b,c){var d=r(a,b),g=r(c,b),h=p(a,b),i=p(c,b),k=(d+g)/2;return b.u=_.isObject(b.controls.left)?b.controls.left:new o.Vector(b.x,b.y),b.v=_.isObject(b.controls.right)?b.controls.right:new o.Vector(b.x,b.y),1e-4>h||1e-4>i?(b.controls.left.copy(b),b.controls.right.copy(b),b):(h*=.33,i*=.33,d>g?k+=l:k-=l,b.controls.left.x=b.x+f(k)*h,b.controls.left.y=b.y+e(k)*h,k-=j,b.controls.right.x=b.x+f(k)*i,b.controls.right.y=b.y+e(k)*i,b)},getReflection:function(a,b,c){var d=a.distanceTo(b);if(1e-4>=d)return c?new o.Vector:a.clone();var e=r(a,b);return new o.Vector(d*Math.cos(e)+(c?0:a.x),d*Math.sin(e)+(c?0:a.y))},angleBetween:function(a,b){var c=a.x-b.x,d=a.y-b.y;return g(d,c)},distanceBetweenSquared:function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},distanceBetween:function(a,b){return h(q(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this),arguments.length>1?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js",this.message=a}}}),o.Utils.Error.prototype=new Error,o.Utils.Error.prototype.constructor=o.Utils.Error,o.Utils.Collection.prototype=new Array,o.Utils.Collection.constructor=o.Utils.Collection,_.extend(o.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);return this.trigger(o.Events.remove,[a]),a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);return this.trigger(o.Events.remove,[a]),a},push:function(){var a=Array.prototype.push.apply(this,arguments);return this.trigger(o.Events.insert,arguments),a},unshift:function(){var a=Array.prototype.unshift.apply(this,arguments);return this.trigger(o.Events.insert,arguments),a},splice:function(){var a,b=Array.prototype.splice.apply(this,arguments);return this.trigger(o.Events.remove,b),arguments.length>2&&(a=this.slice(arguments[0],arguments.length-2),this.trigger(o.Events.insert,a)),b}});var p=o.Utils.distanceBetween,q=o.Utils.distanceBetweenSquared,r=o.Utils.angleBetween,s=o.Utils.getControlPoints,t=(o.Utils.getCurveFromPoints,o.Utils.solveSegmentIntersection,o.Utils.decoupleShapes,o.Utils.mod);_.extend(o.prototype,Backbone.Events,{appendTo:function(a){return a.appendChild(this.renderer.domElement),this},play:function(){return o.Utils.setPlaying.call(this,!0),this.trigger(o.Events.play)},pause:function(){return this.playing=!1,this.trigger(o.Events.pause)},update:function(){var a=!!this._lastFrame,c=b();this.frameCount++,a&&(this.timeDelta=parseFloat((c-this._lastFrame).toFixed(3))),this._lastFrame=c;var d=this.width,e=this.height,f=this.renderer;return(d!==f.width||e!==f.height)&&f.setSize(d,e,this.ratio),this.trigger(o.Events.update,this.frameCount,this.timeDelta),_.defer(_.bind(function(){this.render()},this)),this},render:function(){return this.renderer.render(),this.trigger(o.Events.render,this.frameCount)},add:function(a){var b=a;return _.isArray(a)||(b=_.toArray(arguments)),this.scene.add(b),this},remove:function(a){var b=a;return _.isArray(a)||(b=_.toArray(arguments)),this.scene.remove(b),this},clear:function(){return _.each(this.scene.children,function(a){a.remove()}),this},makeLine:function(a,b,c,d){var e=c-a,f=d-b,g=e/2,h=f/2,i=[new o.Anchor(-g,-h),new o.Anchor(g,h)],j=new o.Polygon(i).noFill();return j.translation.set(a+g,b+h),this.scene.add(j),j},makeRectangle:function(a,b,c,d){var e=c/2,f=d/2,g=[new o.Anchor(e,f),new o.Anchor(-e,f),new o.Anchor(-e,-f),new o.Anchor(e,-f)],h=new o.Polygon(g,!0);return h.translation.set(a,b),this.scene.add(h),h},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,c,d){var g=o.Resolution,h=_.map(_.range(g),function(a){var b=a/g,h=b*k,i=c*f(h),j=d*e(h);return new o.Anchor(i,j)},this),i=new o.Polygon(h,!0,!0);return i.translation.set(a,b),this.scene.add(i),i},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a)){c=[];for(var d=0;b>d;d+=2){var e=arguments[d];if(!_.isNumber(e))break;var f=arguments[d+1];c.push(new o.Anchor(e,f))}}var g=arguments[b-1],h=new o.Polygon(c,!(_.isBoolean(g)?g:void 0),!0),i=h.getBoundingClientRect(),j=i.left+i.width/2,k=i.top+i.height/2;return _.each(h.vertices,function(a){a.x-=j,a.y-=k}),h.translation.set(j,k),this.scene.add(h),h},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a)){c=[];for(var d=0;b>d;d+=2){var e=arguments[d];if(!_.isNumber(e))break;var f=arguments[d+1];c.push(new o.Anchor(e,f))}}var g=arguments[b-1],h=new o.Polygon(c,!(_.isBoolean(g)?g:void 0)),i=h.getBoundingClientRect();return h.center().translation.set(i.left+i.width/2,i.top+i.height/2),this.scene.add(h),h},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new o.Group;return this.scene.add(c),c.add(b),c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in o.Utils.read))return null;var c=o.Utils.read[b].call(this,a);return this.add(c),c}}),function(){_.each(o.Instances,function(a){a.playing&&a.update()}),requestAnimationFrame(arguments.callee)}(),"function"==typeof define&&define.amd?define(function(){return o}):"undefined"!=typeof module&&module.exports&&(module.exports=o)}(),function(){var a=Two.Vector=function(a,b){this.x=a||0,this.y=b||0};_.extend(a,{MakeGetterSetter:function(a,b,c){var d="_"+b;Object.defineProperty(a,b,{get:function(){return this[d]},set:function(a){this[d]=a,this.trigger(Two.Events.change,b)}}),a[d]=c}}),_.extend(a.prototype,Backbone.Events,{set:function(a,b){return this.x=a,this.y=b,this},copy:function(a){return this.x=a.x,this.y=a.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new a(this.x,this.y)},add:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addSelf:function(a){return this.x+=a.x,this.y+=a.y,this},sub:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},subSelf:function(a){return this.x-=a.x,this.y-=a.y,this},multiplySelf:function(a){return this.x*=a.x,this.y*=a.y,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},divideScalar:function(a){return a?(this.x/=a,this.y/=a):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())
},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return this.distanceTo(a)<1e-4},lerp:function(a,b){var c=(a.x-this.x)*b+this.x,d=(a.y-this.y)*b+this.y;return this.set(c,d)},isZero:function(){return this.length()<1e-4},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var b={set:function(a,b){return this._x=a,this._y=b,this.trigger(Two.Events.change)},copy:function(a){return this._x=a.x,this._y=a.y,this.trigger(Two.Events.change)},clear:function(){return this._x=0,this._y=0,this.trigger(Two.Events.change)},clone:function(){return new a(this._x,this._y)},add:function(a,b){return this._x=a.x+b.x,this._y=a.y+b.y,this.trigger(Two.Events.change)},addSelf:function(a){return this._x+=a.x,this._y+=a.y,this.trigger(Two.Events.change)},sub:function(a,b){return this._x=a.x-b.x,this._y=a.y-b.y,this.trigger(Two.Events.change)},subSelf:function(a){return this._x-=a.x,this._y-=a.y,this.trigger(Two.Events.change)},multiplySelf:function(a){return this._x*=a.x,this._y*=a.y,this.trigger(Two.Events.change)},multiplyScalar:function(a){return this._x*=a,this._y*=a,this.trigger(Two.Events.change)},divideScalar:function(a){return a?(this._x/=a,this._y/=a,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this._x*a.x+this._y*a.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this._x-a.x,c=this._y-a.y;return b*b+c*c},setLength:function(a){return this.normalize().multiplyScalar(a)},equals:function(a){return this.distanceTo(a)<1e-4},lerp:function(a,b){var c=(a.x-this._x)*b+this._x,d=(a.y-this._y)*b+this._y;return this.set(c,d)},isZero:function(){return this.length()<1e-4},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){return this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,b),this._bound=!0),Backbone.Events.bind.apply(this,arguments),this}}(),function(){var a=Two.Commands,b=Two.Anchor=function(c,d,e,f,g,h,i){return Two.Vector.call(this,c,d),this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this),Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){return this._command=c,this._command!==a.curve||_.isObject(this.controls)||b.AppendCurveProperties(this),this.trigger(Two.Events.change)}}),this._command=i||a.move,i?(b.AppendCurveProperties(this),_.isNumber(e)&&(this.controls.left.x=e),_.isNumber(f)&&(this.controls.left.y=f),_.isNumber(g)&&(this.controls.right.x=g),void(_.isNumber(h)&&(this.controls.right.y=h))):this};_.extend(b,{AppendCurveProperties:function(a){var b=a._x||a.x,c=a._y||a.y;a.controls={left:new Two.Vector(b,c),right:new Two.Vector(b,c)}}}),_.extend(b.prototype,Two.Vector.prototype,{listen:function(){return _.isObject(this.controls)||b.AppendCurveProperties(this),_.each(this.controls,function(a){a.bind(Two.Events.change,this._broadcast)},this),this},ignore:function(){return _.each(this.controls,function(a){a.unbind(Two.Events.change,this._broadcast)},this),this},clone:function(){var a=this.controls;return new Two.Anchor(this.x,this.y,a&&a.left.x,a&&a.left.y,a&&a.right.x,a&&a.right.y,this.command)}})}(),function(){var a=(_.range(6),Math.cos),b=Math.sin,c=Math.tan,d=Two.Matrix=function(a){this.elements=new Two.Array(9);var b=a;_.isArray(b)||(b=_.toArray(arguments)),this.identity().set(b)};_.extend(d,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,b){if(b.length<=3){var c,d,e,f=b[0]||0,g=b[1]||0,h=b[2]||0,i=a;return c=i[0]*f+i[1]*g+i[2]*h,d=i[3]*f+i[4]*g+i[5]*h,e=i[6]*f+i[7]*g+i[8]*h,{x:c,y:d,z:e}}var j=a[0],k=a[1],l=a[2],m=a[3],n=a[4],o=a[5],p=a[6],q=a[7],r=a[8],s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8];return[j*s+k*v+l*y,j*t+k*w+l*z,j*u+k*x+l*A,m*s+n*v+o*y,m*t+n*w+o*z,m*u+n*x+o*A,p*s+q*v+r*y,p*t+q*w+r*z,p*u+q*x+r*A]}}),_.extend(d.prototype,Backbone.Events,{set:function(a){{var b=a;arguments.length}return _.isArray(b)||(b=_.toArray(arguments)),_.each(b,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this),this.trigger(Two.Events.change)},identity:function(){return this.set(d.Identity),this},multiply:function(a,b,c,d,e){var f=arguments,g=f.length;if(1>=g)return _.each(this.elements,function(b,c){this.elements[c]=b*a},this),this.trigger(Two.Events.change);if(3>=g){var h,i,j;return a=a||0,b=b||0,c=c||0,e=this.elements,h=e[0]*a+e[1]*b+e[2]*c,i=e[3]*a+e[4]*b+e[5]*c,j=e[6]*a+e[7]*b+e[8]*c,{x:h,y:i,z:j}}var k=this.elements,l=f;return A0=k[0],A1=k[1],A2=k[2],A3=k[3],A4=k[4],A5=k[5],A6=k[6],A7=k[7],A8=k[8],B0=l[0],B1=l[1],B2=l[2],B3=l[3],B4=l[4],B5=l[5],B6=l[6],B7=l[7],B8=l[8],this.elements[0]=A0*B0+A1*B3+A2*B6,this.elements[1]=A0*B1+A1*B4+A2*B7,this.elements[2]=A0*B2+A1*B5+A2*B8,this.elements[3]=A3*B0+A4*B3+A5*B6,this.elements[4]=A3*B1+A4*B4+A5*B7,this.elements[5]=A3*B2+A4*B5+A5*B8,this.elements[6]=A6*B0+A7*B3+A8*B6,this.elements[7]=A6*B1+A7*B4+A8*B7,this.elements[8]=A6*B2+A7*B5+A8*B8,this.trigger(Two.Events.change)},inverse:function(a){var b=this.elements,a=a||new Two.Matrix,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,a.elements[0]=l*o,a.elements[1]=(-k*d+e*j)*o,a.elements[2]=(h*d-e*g)*o,a.elements[3]=m*o,a.elements[4]=(k*c-e*i)*o,a.elements[5]=(-h*c+e*f)*o,a.elements[6]=n*o,a.elements[7]=(-j*c+d*i)*o,a.elements[8]=(g*c-d*f)*o,a):null},scale:function(a,b){var c=arguments.length;return 1>=c&&(b=a),this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(c){var d=a(c),e=b(c);return this.multiply(d,-e,0,e,d,0,0,0,1)},translate:function(a,b){return this.multiply(1,0,a,0,1,b,0,0,1)},skewX:function(a){var b=c(a);return this.multiply(1,b,0,0,1,0,0,0,1)},skewY:function(a){var b=c(a);return this.multiply(1,0,0,b,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},toArray:function(a){var b=this.elements,c=parseFloat(b[0].toFixed(3)),d=parseFloat(b[1].toFixed(3)),e=parseFloat(b[2].toFixed(3)),f=parseFloat(b[3].toFixed(3)),g=parseFloat(b[4].toFixed(3)),h=parseFloat(b[5].toFixed(3));if(a){var i=parseFloat(b[6].toFixed(3)),j=parseFloat(b[7].toFixed(3)),k=parseFloat(b[8].toFixed(3));return[c,f,i,d,g,j,e,h,k]}return[c,f,d,g,e,h]},clone:function(){var a=this.elements[0],b=this.elements[1],c=this.elements[2],d=this.elements[3],e=this.elements[4],f=this.elements[5],g=this.elements[6],h=this.elements[7],i=this.elements[8];return new Two.Matrix(a,b,c,d,e,f,g,h,i)}})}(),function(){function a(a){var b={},c=a.id,d=a.translation,g=a.rotation,h=a.scale,i=a.stroke,j=a.linewidth,k=a.fill,l=a.opacity,m=a.visible,n=a.cap,o=a.join,p=a.miter,q=a.closed,r=a.vertices;return c&&(b.id=f.Identifier+c),d&&_.isNumber(h)&&_.isNumber(g)&&(b.transform="matrix("+a._matrix.toString()+")"),i&&(b.stroke=i),k&&(b.fill=k),l&&(b["stroke-opacity"]=b["fill-opacity"]=l),b.visibility=m?"visible":"hidden",n&&(b["stroke-linecap"]=n),o&&(b["stroke-linejoin"]=o),p&&(b["stroke-miterlimit"]=p),j&&(b["stroke-width"]=j),r&&(b.d=e.toString(r,q)),b}function b(a,b,c,d){switch(b){case"matrix":b="transform",c="matrix("+c.toString()+")";break;case"visible":b="visibility",c=c?"visible":"hidden";break;case"cap":b="stroke-linecap";break;case"join":b="stroke-linejoin";break;case"miter":b="stroke-miterlimit";break;case"linewidth":b="stroke-width";break;case"vertices":b="d",c=e.toString(c,d);break;case"opacity":return void e.setAttributes(a,{"stroke-opacity":c,"fill-opacity":c})}a.setAttribute(b,c)}function c(){var a=this.count;return this.count++,a}var d=Two.Utils.mod,e={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(a,b){var c=a,d=document.createElementNS(this.ns,c);return"svg"===c&&(b=_.defaults(b||{},{version:this.version})),_.isObject(b)&&this.setAttributes(d,b),d},setAttributes:function(a,b){return _.each(b,function(a,b){this.setAttribute(b,a)},a),this},removeAttributes:function(a,b){return _.each(b,function(a){this.removeAttribute(a)},a),this},toString:function(a,b){var c=a.length,e=c-1;return _.map(a,function(f,g){var h,i,j,k,l,m,n,o,p,q=b?d(g-1,c):Math.max(g-1,0),r=b?d(g+1,c):Math.min(g+1,e),s=a[q],t=a[r],u=f.x.toFixed(3),v=f.y.toFixed(3);switch(f._command){case Two.Commands.close:h=f._command;break;case Two.Commands.curve:var m=s.controls&&s.controls.right||s,n=f.controls&&f.controls.left||f;i=m.x.toFixed(3),j=m.y.toFixed(3),k=n.x.toFixed(3),l=n.y.toFixed(3),h=f._command+" "+i+" "+j+" "+k+" "+l+" "+u+" "+v;break;default:h=(f._command||(0===g?Two.Commands.move:Two.Commands.line))+" "+u+" "+v}return g>=e&&b&&(f._command===Two.Commands.curve&&(o=f.controls&&f.controls.right||f,p=t.controls&&t.controls.left||t,i=o.x.toFixed(3),j=o.y.toFixed(3),k=p.x.toFixed(3),l=p.y.toFixed(3),u=t.x.toFixed(3),v=t.y.toFixed(3),h+=" C "+i+" "+j+" "+k+" "+l+" "+u+" "+v),h+=" Z"),h}).join(" ")}},f=Two[Two.Types.svg]=function(a){this.count=0,this.domElement=a.domElement||e.createElement("svg"),this.elements=[],this.domElement.style.visibility="hidden",this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(f,{Identifier:"two-",Utils:e}),_.extend(f.prototype,Backbone.Events,{setSize:function(a,b){return this.width=a,this.height=b,e.setAttributes(this.domElement,{width:a,height:b}),this},add:function(b){var d=(arguments.length,b),f=this.elements,g=this.domElement;return _.isArray(b)||(d=_.map(arguments,function(a){return a})),_.each(d,function(b){var d,h,i,j=b instanceof Two.Group;_.isUndefined(b.id)&&(b.id=c.call(this)),j?(h="g",_.isUndefined(b.parent)&&(b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),i=a(b),delete i.stroke,delete i.fill,delete i["fill-opacity"],delete i["stroke-opacity"],delete i["stroke-linecap"],delete i["stroke-linejoin"],delete i["stroke-miterlimit"],delete i["stroke-width"]):(h="path",i=a(b)),d=e.createElement(h,i),g.appendChild(d),f.push(d)},this),this},update:function(a,c,d,e){var f=this.elements,g=f[a];switch(c){case Two.Properties.hierarchy:_.each(d,function(a){g.appendChild(f[a])});break;case Two.Properties.demotion:_.each(d,function(a){g.removeChild(f[a])});break;default:b(g,c,d,e)}return this},render:function(){return this.unveil(),this}})}(),function(){function a(a){var b={},c=a.id,d=a._matrix,e=a.stroke,f=a.linewidth,g=a.fill,h=a.opacity,i=a.visible,j=a.cap,k=a.join,l=a.miter,m=a.closed,n=a.vertices;return c&&(b.id=c),_.isObject(d)&&(b.matrix=d.toArray()),e&&(b.stroke=e),g&&(b.fill=g),_.isNumber(h)&&(b.opacity=h),j&&(b.cap=j),k&&(b.join=k),l&&(b.miter=l),f&&(b.linewidth=f),n&&(b.commands=n),b.visible=!!i,b.closed=!!m,b}function b(a,b,c,d){switch(b){case"matrix":b="matrix",c=c.toArray();break;case"vertices":b="commands",a.closed=d}a[b]=c}function c(){var a=this.count;return this.count++,a}var d=this,e=Two.Utils.mod,f=function(a){_.each(a,function(a,b){this[b]=a},this),this.children=[]};_.extend(f.prototype,{appendChild:function(a){{var b=a.parent;a.id}return _.isUndefined(b)||b.removeChild(a),this.children.push(a),a.parent=this,this},removeChild:function(a){var b=_.indexOf(this.children,a);return 0>b?this:this.children.splice(b,1)[0]},render:function(a){var b=this.matrix;return a.save(),a.transform(b[0],b[1],b[2],b[3],b[4],b[5]),_.each(this.children,function(b){b.render(a)}),a.restore(),this}});var g=function(a){_.each(a,function(a,b){this[b]=a},this)};_.extend(g.prototype,{render:function(a){var b=this.matrix,c=this.stroke,d=this.linewidth,f=this.fill,g=this.opacity,h=this.visible,i=this.cap,j=this.join,k=this.miter,l=this.closed,m=this.commands,n=m.length,o=n-1;return h?(a.save(),b&&a.transform(b[0],b[1],b[2],b[3],b[4],b[5]),f&&(a.fillStyle=f),c&&(a.strokeStyle=c),d&&(a.lineWidth=d),k&&(a.miterLimit=k),j&&(a.lineJoin=j),i&&(a.lineCap=i),_.isNumber(g)&&(a.globalAlpha=g),a.beginPath(),_.each(m,function(b,c){var d,f,g,h,i,j,k,p,q,r,s,t,u=b.x.toFixed(3),v=b.y.toFixed(3);switch(b._command){case Two.Commands.close:a.closePath();break;case Two.Commands.curve:f=l?e(c-1,n):Math.max(c-1,0),d=l?e(c+1,n):Math.min(c+1,o),g=m[f],h=m[d],q=g.controls&&g.controls.right||g,r=b.controls&&b.controls.left||b,k=q.x.toFixed(3),p=q.y.toFixed(3),i=r.x.toFixed(3),j=r.y.toFixed(3),a.bezierCurveTo(k,p,i,j,u,v),c>=o&&l&&(s=b.controls&&b.controls.right||b,t=h.controls&&h.controls.left||h,k=s.x.toFixed(3),p=s.y.toFixed(3),i=t.x.toFixed(3),j=t.y.toFixed(3),u=h.x.toFixed(3),v=h.y.toFixed(3),a.bezierCurveTo(k,p,i,j,u,v));break;case Two.Commands.line:a.lineTo(u,v);break;case Two.Commands.move:a.moveTo(u,v)}}),l&&a.closePath(),a.fill(),a.stroke(),void a.restore()):this}});var h={devicePixelRatio:d.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return this.devicePixelRatio/this.getBackingStoreRatio(a)}},i=Two[Two.Types.canvas]=function(a){this.count=0,this.domElement=a.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=!1,this.elements=[],this.stage=null};_.extend(i,{Group:f,Element:g,getStyles:a,setStyles:b,Utils:h}),_.extend(i.prototype,Backbone.Events,{setSize:function(a,b,c){return this.width=a,this.height=b,this.ratio=_.isUndefined(c)?h.getRatio(this.ctx):c,this.domElement.width=a*this.ratio,this.domElement.height=b*this.ratio,_.extend(this.domElement.style,{width:a+"px",height:b+"px"}),this},add:function(a){var b=Object.getPrototypeOf(this);constructor=b.constructor;var d=(arguments.length,a),e=this.elements,f=(this.domElement,constructor.Group),g=constructor.Element,h=constructor.getStyles;return _.isArray(a)||(d=_.map(arguments,function(a){return a})),_.each(d,function(a){var b,d,i=a instanceof Two.Group,j=_.isNull(this.stage);_.isUndefined(a.id)&&(a.id=c.call(this)),i?(d=h.call(this,a),delete d.stroke,delete d.fill,delete d.opacity,delete d.cap,delete d.join,delete d.miter,delete d.linewidth,b=new f(d),j&&(this.stage=b,this.stage.object=a,this.stage.parent=a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):b=new g(h.call(this,a)),e.push(b),j||this.stage.appendChild(b)},this),this},update:function(a,b,c,d,e){var f=Object.getPrototypeOf(this),g=f.constructor,h=this.elements,i=h[a];switch(b){case Two.Properties.hierarchy:_.each(c,function(a){i.appendChild(h[a])});break;case Two.Properties.demotion:_.each(c,function(a){i.removeChild(h[a]),this.elements[a]=null},this);break;default:g.setStyles.call(this,i,b,c,d,e)}return this},render:function(){if(_.isNull(this.stage))return this;var a=1===this.ratio;return a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),this.stage.render(this.ctx),a||this.ctx.restore(),this}})}(),function(){function a(a){var b={},c=a.id,d=a._matrix,e=a.stroke,f=a.linewidth,g=a.fill,j=a.opacity,k=a.visible,l=a.cap,m=a.join,n=a.miter,o=a.closed,p=a.vertices;return c&&(b.id=c),_.isObject(d)&&(b.matrix=b._matrix=d.toArray(!0),b.scale=b._scale=1),e&&(b.stroke=e),g&&(b.fill=g),_.isNumber(j)&&(b.opacity=j),l&&(b.cap=l),m&&(b.join=m),n&&(b.miter=n),f&&(b.linewidth=f),p&&(b.vertices=p,b.commands=b.vertices,b.rect=i.getBoundingClientRect(b.commands,b.linewidth),b.triangles=i.getTriangles(b.rect)),b.visible=!!k,b.closed=!!o,a instanceof Two.Polygon&&(i.updateBuffer(this.ctx,b,this.program),h.prototype.updateTexture.call(b,this.ctx)),b}function b(a,b,d,e,f){var g=!1;/matrix/.test(b)?(a[b]=d.toArray(!0),_.isNumber(e)&&(g=a.scale!==e,a.scale=e),a.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=d,a.rect=c(i.getBoundingClientRect(a.commands,a.linewidth),a.rect),a.triangles=i.getTriangles(a.rect),i.updateBuffer(this.ctx,a,this.program),g=!0):"vertices"===b?(_.isUndefined(e)||(a.closed=e),f?a.commands=d:(a.vertices=d,a.commands=a.vertices),a.rect=c(i.getBoundingClientRect(a.vertices,a.linewidth),a.rect),a.triangles=i.getTriangles(a.rect),i.updateBuffer(this.ctx,a,this.program),g=!0):a[b]=d,g&&a.updateTexture(this.ctx)}function c(a,b){var c=Math.min(a.top,b.top),d=Math.min(a.left,b.left),e=Math.max(a.right,b.right),f=Math.max(a.bottom,b.bottom),g=e-d,h=f-c,i={x:-d,y:-c};return{top:c,left:d,right:e,bottom:f,width:g,height:h,centroid:i}}var d=Two[Two.Types.canvas],e=Two.Matrix.Multiply,f=Two.Utils.mod,g=function(a){d.Group.call(this,a)};_.extend(g.prototype,d.Group.prototype,{appendChild:function(){return d.Group.prototype.appendChild.apply(this,arguments),this.updateMatrix(),this},updateTexture:function(a){return _.each(this.children,function(b){b.updateTexture(a)}),this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix,c=a&&a._scale||this.parent&&this.parent._scale;return b?(this._matrix=e(this.matrix,b),this._scale=this.scale*c,_.each(this.children,function(a){a.updateMatrix(this)},this),this):this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var h=function(a){d.Element.call(this,a)};_.extend(h.prototype,d.Element.prototype,{updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix,c=a&&a._scale||this.parent&&this.parent._scale;return b?(this._matrix=e(this.matrix,b),this._scale=this.scale*c,this):this},updateTexture:function(a){return i.updateTexture(a,this),this},render:function(a,b){return this.visible&&this.opacity&&this.buffer?(a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer),a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniformMatrix3fv(b.matrix,!1,this._matrix),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6),this):this}});var i={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b){var c=1/0,d=-1/0,e=1/0,f=-1/0;_.each(a,function(a){var b,g,h,i,j=a.x,k=a.y,l=a.controls;if(e=Math.min(k,e),c=Math.min(j,c),d=Math.max(j,d),f=Math.max(k,f),a.controls){var m=l.left,n=l.right;m&&n&&(b=m.x,g=m.y,h=n.x,i=n.y,b&&g&&h&&i&&(e=Math.min(g,i,e),c=Math.min(b,h,c),d=Math.max(b,h,d),f=Math.max(g,i,f)))}}),_.isNumber(b)&&(e-=b,c-=b,d+=b,f+=b);var g=d-c,h=f-e,i={x:-c,y:-e};return{top:e,left:c,right:d,bottom:f,width:g,height:h,centroid:i}},getTriangles:function(a){var b=a.top,c=a.left,d=a.right,e=a.bottom;return new Two.Array([c,b,d,b,c,e,c,e,d,b,d,e])},updateCanvas:function(a){var b=a.commands,c=this.canvas,d=this.ctx,e=a._scale,g=a.stroke,h=a.linewidth*e,i=a.fill,j=a.opacity,k=a.cap,l=a.join,m=a.miter,n=a.closed,o=b.length,p=o-1;c.width=Math.max(Math.ceil(a.rect.width*e),1),c.height=Math.max(Math.ceil(a.rect.height*e),1);var q=a.rect.centroid,r=q.x*e,s=q.y*e;d.clearRect(0,0,c.width,c.height),i&&(d.fillStyle=i),g&&(d.strokeStyle=g),h&&(d.lineWidth=h),m&&(d.miterLimit=m),l&&(d.lineJoin=l),k&&(d.lineCap=k),_.isNumber(j)&&(d.globalAlpha=j),d.beginPath(),_.each(b,function(a,c){var g,h,i,j,k,l,m,q,t,u,v,w,x=(a.x*e+r).toFixed(3),y=(a.y*e+s).toFixed(3);switch(a._command){case Two.Commands.close:d.closePath();break;case Two.Commands.curve:h=n?f(c-1,o):Math.max(c-1,0),g=n?f(c+1,o):Math.min(c+1,p),i=b[h],j=b[g],t=i.controls&&i.controls.right||i,u=a.controls&&a.controls.left||a,m=(t.x*e+r).toFixed(3),q=(t.y*e+s).toFixed(3),k=(u.x*e+r).toFixed(3),l=(u.y*e+s).toFixed(3),d.bezierCurveTo(m,q,k,l,x,y),c>=p&&n&&(v=a.controls&&a.controls.right||a,w=j.controls&&j.controls.left||j,m=(v.x*e+r).toFixed(3),q=(v.y*e+s).toFixed(3),k=(w.x*e+r).toFixed(3),l=(w.y*e+s).toFixed(3),x=(j.x*e+r).toFixed(3),y=(j.y*e+s).toFixed(3),d.bezierCurveTo(m,q,k,l,x,y));break;case Two.Commands.line:d.lineTo(x,y);break;case Two.Commands.move:d.moveTo(x,y)}}),n&&d.closePath(),d.fill(),d.stroke()},updateTexture:function(a,b){this.updateCanvas(b),b.texture&&a.deleteTexture(b.texture),a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer),b.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,b.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),this.canvas.width<=0||this.canvas.height<=0||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer),b.buffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b.buffer),a.enableVertexAttribArray(c.position),a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW),_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer),b.textureCoordsBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer),a.enableVertexAttribArray(c.textureCoords),a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)}),a.linkProgram(c);var d=a.getProgramParameter(c,a.LINK_STATUS);if(!d)throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){var d=a.createShader(a[c]);a.shaderSource(d,b),a.compileShader(d);var e=a.getShaderParameter(d,a.COMPILE_STATUS);if(!e){var f=a.getShaderInfoLog(d);throw a.deleteShader(d),new Two.Utils.Error("unable to compile shader "+d+": "+f)}return d},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};i.ctx=i.canvas.getContext("2d");var j=Two[Two.Types.webgl]=function(a){this.count=0,this.domElement=a.domElement||document.createElement("canvas"),this.elements=[],this.stage=null,this._matrix=[1,0,0,0,1,0,0,0,1],this._scale=1;var b=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=b.overdraw;var c=this.ctx=this.domElement.getContext("webgl",b)||this.domElement.getContext("experimental-webgl",b);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var d=i.shaders.create(c,i.shaders.vertex,i.shaders.types.vertex),e=i.shaders.create(c,i.shaders.fragment,i.shaders.types.fragment);this.program=i.program.create(c,[d,e]),c.useProgram(this.program),this.program.position=c.getAttribLocation(this.program,"a_position"),this.program.matrix=c.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=c.getAttribLocation(this.program,"a_textureCoords"),c.disable(c.DEPTH_TEST),c.enable(c.BLEND),c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)};_.extend(j,{Group:g,Element:h,getStyles:a,setStyles:b}),_.extend(j.prototype,Backbone.Events,d.prototype,{setSize:function(a,b){d.prototype.setSize.apply(this,arguments),a*=this.ratio,b*=this.ratio,this._matrix[0]=this._matrix[4]=this._scale=this.ratio,_.isNull(this.stage)||this.stage.updateMatrix(),this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"u_resolution");return this.ctx.uniform2f(c,a,b),this},render:function(){if(_.isNull(this.stage))return this;var a=this.ctx;return this.overdraw||a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.stage.render(a,this.program),this}})}(),function(){var a=Two.Shape=function(b){this._matrix=new Two.Matrix;var c=_.debounce(_.bind(function(){var a=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",a,this.scale)},this),0);return this._rotation=0,Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(a){this._rotation=a,c()}}),this._scale="scale",Object.defineProperty(this,"scale",{get:function(){return this._scale},set:function(a){this._scale=a,c()}}),this.translation=new Two.Vector,this.rotation=0,this.scale=1,this.translation.bind(Two.Events.change,c),b?this:(a.MakeGetterSetter(this,a.Properties),this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="round",this.join="round",void(this.miter=4))};_.extend(a,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter"],MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]),_.each(b,function(b){var c="_"+b;Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a,this.trigger(Two.Events.change,this.id,b,a,this)}})})}}),_.extend(a.prototype,Backbone.Events,{addTo:function(a){return a.add(this),this},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},clone:function(){var b=new a;return b.translation.copy(this.translation),_.each(a.Properties,function(a){b[a]=this[a]},this),this}})}(),function(){var a=Math.min,b=Math.max,c=Two.Group=function(){Two.Shape.call(this,!0),delete this.stroke,delete this.fill,delete this.linewidth,delete this.opacity,delete this.cap,delete this.join,delete this.miter,c.MakeGetterSetter(this,Two.Shape.Properties),this.children={}};_.extend(c,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]),_.each(b,function(b){var c="_"+b;Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a,_.each(this.children,function(c){c[b]=a})}})})}}),_.extend(c.prototype,Two.Shape.prototype,{clone:function(a){a=a||this.parent;var b=_.map(this.children,function(b){return b.clone(a)}),d=new c;return a.add(d),d.add(b),d.translation.copy(this.translation),d.rotation=this.rotation,d.scale=this.scale,d},corner:function(){var a=this.getBoundingClientRect(!0),b={x:a.left,y:a.top};return _.each(this.children,function(a){a.translation.subSelf(b)}),this},center:function(){var a=this.getBoundingClientRect(!0);return a.centroid={x:a.left+a.width/2,y:a.top+a.height/2},_.each(this.children,function(b){b.translation.subSelf(a.centroid)}),this},add:function(a){var b=(arguments.length,a),c=this.children,d=this.parent,e=[];_.isArray(a)||(b=_.toArray(arguments));var f=_.bind(function(a,b,c,d,e){this.trigger(Two.Events.change,a,b,c,d,e)},this);return _.each(b,function(a){if(a){var b=a.id,g=a.parent;_.isUndefined(b)&&(d.add(a),b=a.id),_.isUndefined(c[b])&&(g&&delete g.children[b],c[b]=a,a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,f),e.push(b))}},this),e.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,e),this},remove:function(a){var b=arguments.length,c=a,d=this.children,e=this.parent,f=[];return 0>=b&&e?(e.remove(this),this):(_.isArray(a)||(c=_.toArray(arguments)),_.each(c,function(a){{var b=a.id;a.children}b in d&&(delete d[b],delete a.parent,a.unbind(Two.Events.change),f.push(b))}),f.length>0&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,f),this)},getBoundingClientRect:function(c){var d=1/0,e=-1/0,f=1/0,g=-1/0;_.each(this.children,function(c){var h=c.getBoundingClientRect(!0);_.isNumber(h.top)&&_.isNumber(h.left)&&_.isNumber(h.right)&&_.isNumber(h.bottom)&&(f=a(h.top,f),d=a(h.left,d),e=b(h.right,e),g=b(h.bottom,g))},this);var h=c?this._matrix:Two.Utils.getComputedMatrix(this),i=h.multiply(d,f,1),j=h.multiply(e,f,1),k=h.multiply(e,g,1),l=h.multiply(d,g,1);return f=a(i.y,j.y,k.y,l.y),d=a(i.x,j.x,k.x,l.x),e=b(i.x,j.x,k.x,l.x),g=b(i.y,j.y,k.y,l.y),{top:f,left:d,right:e,bottom:g,width:e-d,height:g-f}},noFill:function(){return _.each(this.children,function(a){a.noFill()}),this},noStroke:function(){return _.each(this.children,function(a){a.noStroke()}),this},subdivide:function(){return _.each(this.children,function(a){a.subdivide()}),this}})}(),function(){var a=Math.min,b=Math.max,c=Math.round,d=Two.Polygon=function(d,e,f,g){Two.Shape.call(this),this._closed=!!e,this._curved=!!f,this._automatic=!g;var h,i=0,j=1,k=!1,l=!1,m=[],n=_.debounce(_.bind(function(){var a,b,d,e;if(this._automatic&&this.plot(),k||l){a=h.length,e=a-1,b=c(i*e),d=c(j*e),m.length=0;for(var f=b;d+1>f;f++){var g=h[f];m.push(g)}}this.trigger(Two.Events.change,this.id,"vertices",m,this._closed,k),k=!1,l=!1},this),0);return Object.defineProperty(this,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a,n()}}),Object.defineProperty(this,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a,n()}}),Object.defineProperty(this,"automatic",{get:function(){return this._automatic},set:function(a){if(a!==this._automatic){this._automatic=!!a;var b=this._automatic?"ignore":"listen";_.each(this.vertices,function(a){a[b]()},this),n()}}}),Object.defineProperty(this,"beginning",{get:function(){return i},set:function(c){i=a(b(c,0),1),k=!0,n()}}),Object.defineProperty(this,"ending",{get:function(){return j},set:function(c){j=a(b(c,0),1),k=!0,n()}}),Object.defineProperty(this,"vertices",{get:function(){return h},set:function(a){var b=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,n)},this),l=!0,n()},this),c=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,n)},this),l=!0,n()},this);h&&h.unbind(),h=new Two.Utils.Collection(a.slice(0)),h.bind(Two.Events.insert,b),h.bind(Two.Events.remove,c),l=!0,b(h)}}),this.vertices=d,this._automatic?(this.plot(),this):void _.each(this.vertices,function(a){_.isFunction(a.listen)&&a.listen()})};_.extend(d.prototype,Two.Shape.prototype,{clone:function(){var a=_.map(this.vertices,function(a){return a.clone()}),b=new d(a,this._closed,this._curved);return _.each(Two.Shape.Properties,function(a){b[a]=this[a]},this),b.translation.copy(this.translation),b.rotation=this.rotation,b.scale=this.scale,b},corner:function(){var a=this.getBoundingClientRect(!0),b={x:a.left,y:a.top};return _.each(this.vertices,function(a){a.subSelf(b)}),this},center:function(){var a=this.getBoundingClientRect(!0);return a.centroid={x:a.left+a.width/2,y:a.top+a.height/2},_.each(this.vertices,function(b){b.subSelf(a.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(c){var d=this.linewidth/2,e=1/0,f=-1/0,g=1/0,h=-1/0;_.each(this.vertices,function(c){var d=c.x,i=c.y;g=a(i,g),e=a(d,e),f=b(d,f),h=b(i,h)}),g-=d,e-=d,f+=d,h+=d;var i=c?this._matrix:Two.Utils.getComputedMatrix(this),j=i.multiply(e,g,1),k=i.multiply(f,g,1),l=i.multiply(f,h,1),m=i.multiply(e,h,1);return g=a(j.y,k.y,l.y,m.y),e=a(j.x,k.x,l.x,m.x),f=b(j.x,k.x,l.x,m.x),h=b(j.y,k.y,l.y,m.y),{top:g,left:e,right:f,bottom:h,width:f-e,height:h-g}},plot:function(){return this._curved?(Two.Utils.getCurveFromPoints(this.vertices,this._closed),this):(_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this),this)},subdivide:function(){var a,b=this.vertices.length-1,c=this._closed||this.vertices[b].command===Two.Commands.close,d=[];return _.each(this.vertices,function(b,e){var f,g,h,i,j,k,l,m;return 0>=e&&!c?void(a=b):(f=a.x,g=a.y,h=(a.controls&&a.controls.right||a).x,i=(a.controls&&a.controls.right||a).y,j=(b.controls&&b.controls.left||b).x,k=(b.controls&&b.controls.left||b).y,l=b.x,m=b.y,d.push(Two.Utils.subdivide(f,g,h,i,j,k,l,m)),void(a=b))},this),this._manual=!1,this._curved=!1,this.vertices=_.flatten(d),this.plot(),this
}})}(),window.Modernizr=function(a,b,c){function d(a){s.cssText=a}function e(a,b){return typeof a===b}function f(a,b){return!!~(""+a).indexOf(b)}function g(a,b){for(var d in a){var e=a[d];if(!f(e,"-")&&s[e]!==c)return"pfx"==b?e:!0}return!1}function h(a,b,d){for(var f in a){var g=b[a[f]];if(g!==c)return d===!1?a[f]:e(g,"function")?g.bind(d||b):g}return!1}function i(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),f=(a+" "+u.join(d+" ")+d).split(" ");return e(b,"string")||e(b,"undefined")?g(f,b):(f=(a+" "+v.join(d+" ")+d).split(" "),h(f,b,c))}var j,k,l,m="2.7.1",n={},o=!0,p=b.documentElement,q="modernizr",r=b.createElement(q),s=r.style,t=({}.toString,"Webkit Moz O ms"),u=t.split(" "),v=t.toLowerCase().split(" "),w={},x=[],y=x.slice,z=function(a,c,d,e){var f,g,h,i,j=b.createElement("div"),k=b.body,l=k||b.createElement("body");if(parseInt(d,10))for(;d--;)h=b.createElement("div"),h.id=e?e[d]:q+(d+1),j.appendChild(h);return f=["&#173;",'<style id="s',q,'">',a,"</style>"].join(""),j.id=q,(k?j:l).innerHTML+=f,l.appendChild(j),k||(l.style.background="",l.style.overflow="hidden",i=p.style.overflow,p.style.overflow="hidden",p.appendChild(l)),g=c(j,a),k?j.parentNode.removeChild(j):(l.parentNode.removeChild(l),p.style.overflow=i),!!g},A=function(b){var c=a.matchMedia||a.msMatchMedia;if(c)return c(b).matches;var d;return z("@media "+b+" { #"+q+" { position: absolute; } }",function(b){d="absolute"==(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle).position}),d},B={}.hasOwnProperty;l=e(B,"undefined")||e(B.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return B.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=y.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(y.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(y.call(arguments)))};return d}),w.csstransitions=function(){return i("transition")};for(var C in w)l(w,C)&&(k=C.toLowerCase(),n[k]=w[C](),x.push((n[k]?"":"no-")+k));return n.addTest=function(a,b){if("object"==typeof a)for(var d in a)l(a,d)&&n.addTest(d,a[d]);else{if(a=a.toLowerCase(),n[a]!==c)return n;b="function"==typeof b?b():b,"undefined"!=typeof o&&o&&(p.className+=" "+(b?"":"no-")+a),n[a]=b}return n},d(""),r=j=null,function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=s.elements;return"string"==typeof a?a.split(" "):a}function e(a){var b=r[a[p]];return b||(b={},q++,a[p]=q,r[q]=b),b}function f(a,c,d){if(c||(c=b),k)return c.createElement(a);d||(d=e(c));var f;return f=d.cache[a]?d.cache[a].cloneNode():o.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!f.canHaveChildren||n.test(a)||f.tagUrn?f:d.frag.appendChild(f)}function g(a,c){if(a||(a=b),k)return a.createDocumentFragment();c=c||e(a);for(var f=c.frag.cloneNode(),g=0,h=d(),i=h.length;i>g;g++)f.createElement(h[g]);return f}function h(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return s.shivMethods?f(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(s,b.frag)}function i(a){a||(a=b);var d=e(a);return s.shivCSS&&!j&&!d.hasCSS&&(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),k||h(a,d),a}var j,k,l="3.7.0",m=a.html5||{},n=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,o=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,p="_html5shiv",q=0,r={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",j="hidden"in a,k=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(c){j=!0,k=!0}}();var s={elements:m.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:l,shivCSS:m.shivCSS!==!1,supportsUnknownElements:k,shivMethods:m.shivMethods!==!1,type:"default",shivDocument:i,createElement:f,createDocumentFragment:g};a.html5=s,i(b)}(this,b),n._version=m,n._domPrefixes=v,n._cssomPrefixes=u,n.mq=A,n.testProp=function(a){return g([a])},n.testAllProps=i,n.testStyles=z,n.prefixed=function(a,b,c){return b?i(a,b,c):i(a,"pfx")},p.className=p.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(o?" js "+x.join(" "):""),n}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==q.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=r.shift();s=1,a?a.t?o(function(){("c"==a.t?m.injectCss:m.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):s=0}function i(a,c,d,e,f,i,j){function k(b){if(!n&&g(l.readyState)&&(t.r=n=1,!s&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&o(function(){v.removeChild(l)},50);for(var d in A[c])A[c].hasOwnProperty(d)&&A[c][d].onload()}}var j=j||m.errorTimeout,l=b.createElement(a),n=0,q=0,t={t:d,s:c,e:f,a:i,x:j};1===A[c]&&(q=1,A[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,q)},r.splice(e,0,t),"img"!=a&&(q||2===A[c]?(v.insertBefore(l,u?null:p),o(k,j)):A[c].push(l))}function j(a,b,c,d,f){return s=0,b=b||"j",e(a)?i("c"==b?x:w,a,b,this.i++,c,d,f):(r.splice(this.i++,0,a),1==r.length&&h()),this}function k(){var a=m;return a.loader={load:j,i:0},a}var l,m,n=b.documentElement,o=a.setTimeout,p=b.getElementsByTagName("script")[0],q={}.toString,r=[],s=0,t="MozAppearance"in n.style,u=t&&!!b.createRange().compareNode,v=u?n:p.parentNode,n=a.opera&&"[object Opera]"==q.call(a.opera),n=!!b.attachEvent&&!n,w=t?"object":n?"script":"img",x=n?"script":w,y=Array.isArray||function(a){return"[object Array]"==q.call(a)},z=[],A={},B={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}};m=function(a){function b(a){var b,c,d,a=a.split("!"),e=z.length,f=a.pop(),g=a.length,f={url:f,origUrl:f,prefixes:a};for(c=0;g>c;c++)d=a[c].split("="),(b=B[d.shift()])&&(f=b(f,d));for(c=0;e>c;c++)f=z[c](f);return f}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(A[i.url]?i.noexec=!0:A[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),A[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}),g(a,l,b,0,j);else if(Object(a)===a)for(i in h=function(){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}(),a)a.hasOwnProperty(i)&&(!c&&!--h&&(d(l)?l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}:l[i]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),n()}}(m[i])),g(a[i],l,b,i,j))}else!c&&n()}var h,i,j=!!a.test,k=a.load||a.both,l=a.callback||f,m=l,n=a.complete||f;c(j?a.yep:a.nope,!!k),k&&c(k)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(y(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):y(j)?m(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},m.addPrefix=function(a,b){B[a]=b},m.addFilter=function(a){z.push(a)},m.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",l=function(){b.removeEventListener("DOMContentLoaded",l,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k,l,n=b.createElement("script"),e=e||m.errorTimeout;n.src=a;for(l in d)n.setAttribute(l,d[l]);c=j?h:c||f,n.onreadystatechange=n.onload=function(){!k&&g(n.readyState)&&(k=1,c(),n.onload=n.onreadystatechange=null)},o(function(){k||(k=1,c(1))},e),i?n.onload():p.parentNode.insertBefore(n,p)},a.yepnope.injectCss=function(a,c,d,e,g,i){var j,e=b.createElement("link"),c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(p.parentNode.insertBefore(e,p),o(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},console.log("Developed with love by frenchies at JVST Inc");var host=window.document.location.host.replace(/:.*/,""),port="9000",ws=new Socket;ws.connect(host,port);var type="svg",two=new Two({type:Two.Types[type],fullscreen:!0,autostart:!0}).appendTo(document.body),sky=new Sky(two);Two.Resolution=32;var audio=document.getElementById("audio"),isplaying=!0;audio.volume=.4,audio.loop=!0,audio.play();var volume=document.getElementById("volume");volume.addEventListener("click",function(){isplaying?(audio.pause(),volume.className="btn off"):(audio.play(),volume.className="btn on"),isplaying=!isplaying}),ws.events.addEventListener(ws.EVENT.WELCOME,function(a){var b,c,d=JSON.parse(a.detail),e=d.data.length;for(console.log("listener: welcome",d.data),c=0;e>c;c++)b=new Spaceship(d.data[c].id,ws,two)}),ws.events.addEventListener(ws.EVENT.NEW_USER,function(a){{var b=JSON.parse(a.detail),c=b.data.id;new Spaceship(c,ws,two)}});var Sky=function(a){for(var b,c,d,e,f,g,h=[],i=2,j=0;2*i>j;j++){c={},c.elt=a.makeGroup(),c.speed=Math.ceil((j+1)/2),c.xGroup=a.width*(j%2),f=Math.round(10*Math.random())+10;for(var k=0;f>k;k++)d=Math.round(Math.random()*a.width),e=Math.round(Math.random()*a.height),g=Math.round(20*Math.random())/10,b=a.makeCircle(d,e,g),b.noStroke().fill="#FFFFFF",c.elt.add(b);c.elt.translation.set(c.xGroup,0),h.push(c)}a.bind("update",function(){for(var b=0;2*i>b;b++){var c=h[b];c.xGroup=c.xGroup-c.speed,c.elt.translation.set(c.xGroup,0),c.xGroup<-a.width&&(c.xGroup=a.width)}})},Socket=function(a){var b={HELLO:"hello",AUTH:"auth",WELCOME:"welcome",NEW_USER:"newuser",CLOSE_USER:"closeuser",WEB:"web",APP:"app",MOUSE_MOVE:"mousemove",CLICK:"click",KEY_DOWN:"keydown",MOUSE_WHEEL:"scroll",MESSENGER:"messenger",MESSAGE:"onmessage"},c=function(){console.log("connection open")},d=function(a){var c,d=JSON.parse(a.data),e=new CustomEvent(b.MESSAGE,{detail:a.data});switch(this.dispatchEvent(e),d.type){case b.HELLO:c='{"type":"'+b.AUTH+'", "id": "'+d.data.id+'", "client": "'+b.WEB+'"}',this.send(c);break;case b.WELCOME:e=new CustomEvent(b.WELCOME,{detail:a.data}),this.dispatchEvent(e);break;case b.NEW_USER:e=new CustomEvent(b.NEW_USER,{detail:a.data}),this.dispatchEvent(e);break;case b.CLOSE_USER:e=new CustomEvent(b.CLOSE_USER,{detail:a.data}),console.log(b.CLOSE_USER+"_",d.data.id),e=new CustomEvent(b.CLOSE_USER+"_"+d.data.id,{detail:a.data}),this.dispatchEvent(e);break;case b.MOUSE_MOVE:case b.CLICK:case b.KEY_DOWN:case b.MOUSE_WHEEL:case b.MESSENGER:e=new CustomEvent(d.type,{detail:a.data}),this.dispatchEvent(e),e=new CustomEvent(d.type+"_"+d.id,{detail:a.data}),this.dispatchEvent(e)}};return function(){this.EVENT=b,this.connect=function(b,e){this.events=new a("ws://"+b+":"+e+"/"),this.events.onopen=c,this.events.onmessage=d}}}(WebSocket),Spaceship=function(a,b,c){function d(){o=document.createElement("canvas"),o.id="ufo_canvas"+a,o.width=c.width,o.height=c.height,o.style.position="fixed",o.style.top="0px",document.body.appendChild(o),p=document.getElementById("ufo_canvas"+a).getContext("2d"),q=Math.floor(Math.random()*U.length),r=U[q],s=new Image,s.src=r.src,p.drawImage(s,r.x,r.y)}function e(){for(t=c.makeCircle(0,0,50),t.fill=t.stroke=r.smokecolor,t.opacity=.5,t.scale=0,K=0;K<t.vertices.length;K++)n=t.vertices[K],n.originalX=n.x;for(u=c.makeCircle(0,0,10),u.fill=u.stroke=r.smokecolor2,u.opacity=.5,u.scale=0,K=0;K<u.vertices.length;K++)n=u.vertices[K],n.originalX=n.x;v=c.makeGroup(t,u)}function f(){var a={};a.elt=c.makeCircle(z.x,z.y,D),a.elt.noStroke().fill="rgba("+C+", 1)",a.index=0,a.type="cos",a.xInit=z.x,a.x=z.x,a.y=z.y,a.z=1;var b={};b.elt=c.makeCircle(z.x,z.y,D),b.elt.noStroke().fill="rgba("+C+", 1)",b.index=0,b.type="sin",b.xInit=z.x,b.x=z.x,b.y=z.y,b.z=1,w.push(a),w.push(b)}function g(b){M=b,l&&clearInterval(l),N=1,O=0,k||(k=document.createElement("canvas"),k.id="canvas_text"+a,k.width=c.width,k.height=c.height,k.style.position="fixed",k.style.top="0px",document.body.appendChild(k),m=document.getElementById("canvas_text"+a).getContext("2d")),l=setInterval(h,60)}function h(){m.clearRect(0,0,c.width,c.height),m.save(),m.translate(z.x+O-50,z.y+O-50),m.font="20px pwperspectivemedium",m.fillStyle="rgba(255,255,255,"+N+")",m.fillText(M,0,0),m.restore(),O-=10,-100>O&&(N-=.2),0>=N&&(clearInterval(l),m.clearRect(0,0,c.width,c.height))}function i(a,b){console.log("getlaser");var d;switch(q){case 0:d=c.makeRectangle(0,0,20,2),d.noStroke().fill="#FFDC99";break;case 1:d=c.makeRectangle(0,0,20,2),d.noStroke().fill="#FFDC99";break;default:d=c.makeGroup();var e=c.makeRectangle(50,0,20,20);e.rotation=Math.PI/4;var f=e.clone();f.translation.x=60,d.add(e,f),d.noFill().stroke="#00F0FF"}return d.translation.x=a,d.translation.y=b,d}var j,k,l,m,n,o,p,q,r,s,t,u,v,w=[],x=[],y=new Two.Vector,z=new Two.Vector,A=new Two.Vector,B="255, 255, 255",C="255, 255, 255",D=20,E=.5,F=200,G=5,H=.5,I=480,J=5,K=0,L=10,M="",N=1,O=0,P=document.getElementById("laser"),Q=document.getElementById("reactor_audio"),R={src:"/images/ship1.png",x:10,y:-52,smokecolor:"#ffcf0f",smokecolor2:"#FF5A00"},S={src:"/images/ship2.png",x:20,y:-80,smokecolor:"#FFFFFF",smokecolor2:"#FFFFFF"},T={src:"/images/ship3.png",x:20,y:-60,smokecolor:"#00F0FF",smokecolor2:"#FFFFFF"},U=[R,S,T];d(),e(),b.events.addEventListener(b.EVENT.MOUSE_MOVE+"_"+a,function(a){var b=JSON.parse(a.detail);z.x=Math.round(b.data.pos.x)*c.width/b.data.screen.width,z.y=c.height-Math.round(b.data.pos.y)*c.height/b.data.screen.height,A.x=b.data.delta.x,A.y=b.data.delta.y}),b.events.addEventListener(b.EVENT.CLOSE_USER+"_"+a,function(){for(clearInterval(j),K=0;K<w.length;K++)w[K].elt.remove();w=[],v.remove(),o.remove()}),b.events.addEventListener(b.EVENT.CLICK+"_"+a,function(){var a={};a.elt=i(z.x,z.y),a.xInit=z.x,a.x=z.x+200,a.y=z.y,x.push(a),P&&(P.currentTime=0,P.play())}),b.events.addEventListener(b.EVENT.MOUSE_WHEEL+"_"+a,function(){t.scale<1&&(t.scale+=.04,u.scale+=.04),Q&&(Q.currentTime=0,Q.play())}),b.events.addEventListener(b.EVENT.MESSENGER+"_"+a,function(a){var b=JSON.parse(a.detail);g(b.data.msg)}),j=setInterval(f,F),c.bind("update",function(){for(y.copy(z).subSelf(v.translation),v.translation.addSelf(y),v.rotation=Math.PI/2*(A.y/100),p.clearRect(0,0,c.width,c.height),p.save(),p.translate(z.x,z.y),p.rotate(Math.PI/2*(A.y/100)),p.drawImage(s,r.x,r.y),p.restore(),K=0;K<x.length;K++){var a=x[K];a.x+=L,a.elt.translation.set(a.x,a.y),a.x>c.width&&(a.elt.remove(),x.splice(K,1))}for(K=0;K<w.length;K++){var b=w[K];b.x-=J;var d=b.index*G%360,e=d*(Math.PI/180),f="";"cos"===b.type&&(b.y+=Math.cos(e)*G*H,d>0&&180>=d&&(b.z=d/180+E),d>180&&360>=d&&(b.z=1-(d-180)/180+E),f=B),"sin"===b.type&&(b.y+=-Math.cos(e)*G*H,d>0&&180>=d&&(b.z=1-d/180+E),d>180&&360>=d&&(b.z=(d-180)/180+E),f=C);var g=1-(b.xInit-b.x)/I;b.elt.scale=g*b.z/2,b.elt.noStroke().fill="rgba("+f+", "+g*b.z+")",b.elt.translation.set(b.x,b.y),b.index++,b.x<=b.xInit-I?(b.xInit=z.x,b.x=z.x,b.y=z.y,b.index=0,clearInterval(j)):(g=1-(b.xInit-b.x)/I,b.elt.scale=g*b.z/2,b.elt.opacity=g*b.z,b.elt.translation.set(b.x,b.y),b.index++)}if(t.scale>0)for(t.scale-=.01,u.scale-=.01,K=0;K<t.vertices.length;K++)if(n=t.vertices[K],n.x<0){var h=Math.floor(50*Math.random()+1);n.x=n.originalX-h;var i=u.vertices[K];i.x=i.originalX-h}})},httpRequest,stats,Stats=function(){var a=this;this.header=document.getElementsByTagName("header")[0],this.btn=document.getElementById("stats"),this.overlay=document.getElementById("overlay"),this.close=document.getElementById("close"),this.intervalId=0,this.currentClass=0,this.aClass=["distance","click","scroll"],this.btn.addEventListener("click",function(){a.overlay.className="",a.header.className="",setTimeout(function(){a.overlay.className="visible"},100),setTimeout(function(){a.header.className="hide"},500),makeRequest("/socket/all/")}),this.close.addEventListener("click",function(){a.overlay.className="",a.header.className="",clearInterval(this.intervalId),setTimeout(function(){a.overlay.className="hide"},500),setTimeout(function(){a.header.className="visible"},100)})};Stats.prototype.display=function(a){var b,c=this,d=JSON.parse(a),e=d.data.length,f=this.overlay.getElementsByTagName("table"),g='<tr><td>username</td><td class="distance active">distance</td><td class="click">click</td><td class="scroll">scroll</td></tr>';if("socket"===d.type){for(b=0;e>b;b++)g+="<tr><td>"+d.data[b].username+'</td><td class="distance active">'+Math.round(.083333*d.data[b].distance/150)+' ft</td><td class="click">'+d.data[b].click+'</td><td class="scroll">'+Math.round(.083333*d.data[b].scroll/150)+" ft</td></tr>";f[0].innerHTML=g,this.intervalId=setInterval(function(){var a=f[0].getElementsByClassName(c.aClass[c.currentClass]);for(b=0;b<a.length;b++)a[b].className=c.aClass[c.currentClass];for(c.currentClass++,c.currentClass>=c.aClass.length&&(c.currentClass=0),a=f[0].getElementsByClassName(c.aClass[c.currentClass]),b=0;b<a.length;b++)a[b].className=c.aClass[c.currentClass]+" active"},5e3)}},stats=new Stats;